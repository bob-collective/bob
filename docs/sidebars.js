// @ts-check

const fs = require("fs");
const contractDir = "docs/contracts/src/src/gateway";
// Check if the contract directory exists and is a directory
const contractItems =
  fs.existsSync(contractDir) && fs.lstatSync(contractDir).isDirectory()
    ? fs
        .readdirSync(contractDir, { withFileTypes: true })
        .filter((dirent) => dirent.isDirectory())
        .map((dirent) => ({
          type: "category",
          label: `${dirent.name.charAt(0).toUpperCase()}${dirent.name.slice(
            1,
          )}`, // Capitalize the first letter of the directory name
          items: [
            {
              type: "autogenerated",
              dirName: `contracts/src/src/gateway/${dirent.name}`,
            },
          ],
        }))
    : [
        {
          type: "category",
          label: "Contracts",
          items: ["contracts/contract_references"], // Default item when the directory doesn't exist or is not a directory
        },
      ];

/** @type {import('@docusaurus/plugin-content-docs').SidebarsConfig} */
const sidebars = {
  // By default, Docusaurus generates a sidebar from the docs folder structure
  learnSidebar: [{ type: "autogenerated", dirName: "learn" }],
  contractSidebar: [
    {
      type: "category",
      label: "Contracts",
      collapsed: false,
      items: contractItems,
    },
  ],
};

module.exports = sidebars;
